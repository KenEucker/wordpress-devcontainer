#!/bin/bash
sourceFolder='src'
themeFolder="$sourceFolder/theme"
pluginFolder="$sourceFolder/plugin"
nodeModulesFolder="node_modules"

sudo chmod -R 777 $sourceFolder

if [ !"$(ls -A $sourceFolder)" ]; then
	node pull.js "$@"
fi


if [ "$(ls -A $themeFolder)" ]; then

	cd $themeFolder

	if [ ! -d "$nodeModulesFolder" ]; then
		npm install
	fi

	cd ../..

	if [ ! -d "$themeFolder/gulpfile.js" ]; then
		./node_modules/.bin/gulp -f $themeFolder/gulpfile.js compile
	fi
fi

if [ "$(ls -A $pluginFolder)" ]; then

	cd $pluginFolder

	if [ ! -d "$nodeModulesFolder" ]; then
		npm install
	fi

	cd ../..

	if [ ! -d "$pluginFolder/gulpfile.js" ]; then
		./node_modules/.bin/gulp -f $pluginFolder/gulpfile.js compile
	fi
fi
